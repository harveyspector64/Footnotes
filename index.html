<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0"
/>
<title>Footnotes of Creation • Archive</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.gstatic.com" />
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
  rel="stylesheet"
/>

<!-- Lenis inertial scroll (can be swapped later) -->
<script
  defer
  src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.38/bundled/lenis.min.js"
></script>

<style>
/* 1 RESET & THEME ------------------------------------------------------- */
*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
:root {
  --bg: #0c0c0d;
  --panel: #111;
  --card: #171719;
  --stroke: #2a2a2d;
  --txt: #e4e4e4;
  --muted: #8a8a8a;
  --accent: #53ff00;
  --ease: cubic-bezier(0.25, 0.1, 0.25, 1);
  font-family: "Inter", system-ui, sans-serif;
  font-size: clamp(15px, 1.2vw + 0.3rem, 18px);
}
html,
body {
  height: 100%;
  background: var(--bg);
  color: var(--txt);
  scroll-behavior: smooth;
}

/* Optional grain for analogue vibe */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=");
  opacity: 0.06;
  mix-blend-mode: overlay;
  z-index: 5;
}

/* 2 TOP BAR ------------------------------------------------------------- */
header {
  position: fixed;
  inset: 0 0 auto 0;
  padding: 0.65rem 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  backdrop-filter: blur(6px);
  background: #0008;
  border-bottom: 1px solid var(--stroke);
  z-index: 900;
}
header h1 {
  font-size: 0.9rem;
  letter-spacing: 2px;
  color: var(--accent);
}
nav#filters {
  display: flex;
  gap: 1rem;
  position: relative;
}
nav#filters button {
  background: none;
  border: none;
  color: var(--txt);
  font-weight: 600;
  cursor: pointer;
  letter-spacing: 1px;
  padding: 0.1rem 0.2rem;
}
nav#filters button.active {
  color: var(--accent);
}
nav#filters::after {
  content: "";
  position: absolute;
  height: 2px;
  background: var(--accent);
  bottom: -5px;
  left: 0;
  width: var(--uw, 0);
  transform: translateX(var(--ux, 0));
  transition: 0.3s var(--ease);
}
#searchWrap {
  position: relative;
}
#searchInput {
  width: 140px;
  padding: 0.2rem 0.4rem;
  background: transparent;
  border: 1px solid var(--stroke);
  color: var(--txt);
  transition: border 0.2s;
}
#searchInput:focus {
  outline: none;
  border-color: var(--accent);
}

/* 3 GRID --------------------------------------------------------------- */
main {
  padding: 5.5rem 2vw 3rem;
}
.container {
  max-width: 1440px;
  margin: 0 auto;
}
.grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
}
.card {
  background: var(--card);
  border: 1px solid var(--stroke);
  cursor: pointer;
  overflow: hidden;
  transition: transform 0.35s var(--ease), box-shadow 0.35s var(--ease);
  opacity: 0;
  transform: translateY(40px);
}
.card.revealed {
  opacity: 1;
  transform: translateY(0);
}
.card:hover {
  transform: translateY(-4px) scale(1.015);
  box-shadow: 0 6px 12px #0006;
}
.card img {
  width: 100%;
  aspect-ratio: 4/3;
  object-fit: cover;
  display: block;
  filter: grayscale(0.05) contrast(1.05);
}
.meta {
  padding: 0.9rem 0.9rem 1.2rem;
  font-size: 0.85rem;
}
.meta h3 {
  font-size: 1.05rem;
  font-weight: 600;
  margin: 0.25rem 0 0.4rem;
}
.tag {
  font-size: 0.65rem;
  color: var(--muted);
  text-transform: uppercase;
}

/* 4 SIDE PANEL ---------------------------------------------------------- */
#panel {
  position: fixed;
  top: 0;
  right: -100%;
  height: 100%;
  width: 33%;
  min-width: 310px;
  background: var(--panel);
  box-shadow: -6px 0 20px #000a;
  overflow-y: auto;
  transition: right 0.65s var(--ease);
  z-index: 950;
  display: flex;
  flex-direction: column;
  backdrop-filter: blur(4px);
}
#panel.open {
  right: 0;
}
#panel header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.2rem;
  border-bottom: 1px solid var(--stroke);
}
#panel header h2 {
  font-size: 1rem;
  color: var(--accent);
}
.close-btn {
  background: none;
  border: none;
  font-size: 1.4rem;
  color: var(--txt);
  cursor: pointer;
}
.body {
  padding: 1.25rem 1.4rem 3rem;
  font-size: 0.95rem;
  line-height: 1.6;
}
.body img,
.body video,
.body iframe {
  width: 100%;
  aspect-ratio: 16 / 9;
  margin: 0.9rem 0;
  border: 1px solid var(--stroke);
  object-fit: cover;
}
.footnotes {
  margin-top: 1rem;
  border-top: 1px dashed var(--stroke);
  padding-top: 0.7rem;
  font-size: 0.8rem;
  color: var(--muted);
}
@media (max-width: 680px) {
  #panel {
    width: 100%;
  }
}

/* 5 SCROLLBAR (subtle) -------------------------------------------------- */
::-webkit-scrollbar {
  width: 6px;
}
::-webkit-scrollbar-thumb {
  background: var(--stroke);
  border-radius: 3px;
}
</style>
</head>
<body>
<!--!!! Cursor follower removed completely -->

<!-- HEADER -->
<header>
  <h1>FOC • ARCHIVE</h1>

  <nav id="filters" aria-label="Filter">
    <button data-filter="all" class="active">all</button>
    <button data-filter="vision">vision</button>
    <button data-filter="text">text</button>
    <button data-filter="promo">promo</button>
  </nav>

  <div id="searchWrap">
    <input
      type="search"
      id="searchInput"
      placeholder="search…"
      aria-label="Search artefacts"
    />
  </div>
</header>

<!-- GRID -->
<main>
  <div class="container">
    <section class="grid" id="grid">
      <!-- SAMPLE CARDS (replace /  populate via JSON later) -->
      <article class="card" data-tags="vision promo">
        <img
          src="https://placehold.co/640x480/ff2e2e/000?text=Genesis+Poster"
          alt=""
          loading="lazy"
        />
        <div class="meta">
          <span class="tag">vision</span>
          <h3>Genesis Key-Art</h3>
          <span class="date">Day 0</span>
        </div>
      </article>

      <article class="card" data-tags="text">
        <img
          src="https://placehold.co/640x480/1e90ff/000?text=Chapter+Scrap"
          alt=""
          loading="lazy"
        />
        <div class="meta">
          <span class="tag">text</span>
          <h3>Clamor in the Void</h3>
          <span class="date">Fragment 134</span>
        </div>
      </article>

      <article class="card" data-tags="promo">
        <img
          src="https://placehold.co/640x480/00af64/000?text=30s+Trailer"
          alt=""
          loading="lazy"
        />
        <div class="meta">
          <span class="tag">promo</span>
          <h3>Teaser Clip</h3>
          <span class="date">Now</span>
        </div>
      </article>
    </section>
  </div>
</main>

<!-- SIDE PANEL -->
<aside id="panel" aria-hidden="true">
  <header>
    <h2 id="panelTitle">Title</h2>
    <button class="close-btn" aria-label="Close">&times;</button>
  </header>
  <div class="body" id="panelBody"></div>
</aside>

<!-- JS ------------------------------------------------------------------ -->
<script>
/* Lenis --------------------------------------------------------------- */
const lenis = new Lenis({ gestureOrientation: "vertical" });
function raf(t) {
  lenis.raf(t);
  requestAnimationFrame(raf);
}
requestAnimationFrame(raf);

/* Filter underline ---------------------------------------------------- */
const btns = [...document.querySelectorAll("#filters button")];
const cards = [...document.querySelectorAll(".card")];
function underline(btn) {
  const nav = btn.parentElement,
    r = btn.getBoundingClientRect(),
    p = nav.getBoundingClientRect();
  nav.style.setProperty("--uw", `${r.width}px`);
  nav.style.setProperty("--ux", `${r.left - p.left}px`);
}
btns.forEach((b) =>
  b.addEventListener("click", () => {
    btns.forEach((x) => x.classList.remove("active"));
    b.classList.add("active");
    underline(b);
    filterCards(b.dataset.filter);
  })
);
underline(document.querySelector("#filters .active"));

function filterCards(tag) {
  cards.forEach((c) => {
    const show = tag === "all" || c.dataset.tags.includes(tag);
    c.style.display = show ? "block" : "none";
  });
}

/* Simple search ------------------------------------------------------- */
const searchInput = document.getElementById("searchInput");
searchInput.addEventListener("input", () => {
  const q = searchInput.value.trim().toLowerCase();
  cards.forEach((card) => {
    const title = card.querySelector("h3").textContent.toLowerCase();
    card.style.display = title.includes(q) ? "block" : "none";
  });
});

/* Reveal on scroll (IntersectionObserver) ----------------------------- */
const io = new IntersectionObserver(
  (entries) => {
    entries.forEach((e) => {
      if (e.isIntersecting) {
        e.target.classList.add("revealed");
        io.unobserve(e.target);
      }
    });
  },
  { threshold: 0.15 }
);
cards.forEach((c) => io.observe(c));

/* Side-panel logic ---------------------------------------------------- */
const panel = document.getElementById("panel");
const panelTitle = document.getElementById("panelTitle");
const panelBody = document.getElementById("panelBody");

cards.forEach((c) =>
  c.addEventListener("click", () => {
    populatePanel(c);
  })
);

function populatePanel(card) {
  const tag = card.dataset.tags.split(" ")[0];
  let html = "";
  if (tag === "vision") {
    html = `
      <p>High-resolution poster art foreshadowing cosmic turmoil.</p>
      <img src="https://placehold.co/900x600/ff2e2e/000?text=Full+Poster" alt="">
      <div class="footnotes">Footnote 42 — litho-printed on photon-paper.</div>`;
  } else if (tag === "text") {
    html = `
      <p><strong>Excerpt — Clamor in the Void</strong></p>
      <p>“In the Before, which is to say the Never-Quite-But-Almost, there roll’d …”</p>`;
  } else {
    html = `
      <iframe src="https://www.youtube.com/embed/TlP5WIxVirU" title="teaser" allowfullscreen></iframe>
      <p>Placeholder clip. Swap embed URL.</p>`;
  }
  panelTitle.textContent = card.querySelector("h3").textContent;
  panelBody.innerHTML = html;
  panel.classList.add("open");
  panel.setAttribute("aria-hidden", "false");
}

function closePanel() {
  panel.classList.remove("open");
  panel.setAttribute("aria-hidden", "true");
}
document.querySelector(".close-btn").onclick = closePanel;
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") closePanel();
});
</script>
</body>
</html>
